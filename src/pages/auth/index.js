import React from "react";
import { Link } from "@reach/router";
import { useDispatch } from "react-redux";
import { Formik } from "formik";
import * as yup from "yup";

import * as authAction from "../../redux/actions/authAction";

import {
  Container,
  StyledForm,
  Wrapper,
  SubText,
  Title,
  GradientBackground,
  FormGroup,
  InputWrapper,
  BottomFormGroup,
  Button,
  SocialLogin,
  SmallScreenTopTitles,
  FormWrapper,
} from "./styles";

// Form validation logic using yup object
const formSchema = yup.object().shape({
  username: yup.string().required(),
  password: yup.string().required().min(6),
});

const Auth = () => {
  const dispatch = useDispatch();

  return (
    // Using formik to create a controlled component
    <Formik
      initialValues={{
        username: "",
        password: "",
      }}
      validationSchema={formSchema}
      onSubmit={(values) => {
        dispatch(authAction.loginUser(values))
          .then(async (result) => {
            //Dispatch action to log in user
            console.log(result);
          })
          .catch((err) => console.log(err));
      }}
    >
      {(props) => (
        <Container>
          <Wrapper>
            <SmallScreenTopTitles>
              <div className="logo">
                <svg
                  width="49"
                  height="49"
                  viewBox="0 0 49 49"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    opacity="0.15"
                    d="M24 41C33.3888 41 41 33.3888 41 24C41 14.6112 33.3888 7 24 7C14.6112 7 7 14.6112 7 24C7 33.3888 14.6112 41 24 41Z"
                    fill="white"
                  />
                  <path
                    opacity="0.4"
                    d="M10.5021 20.9999C6.2559 20.9984 2.42811 18.441 0.801589 14.5188C-0.824927 10.5966 0.069695 6.08091 3.06877 3.07503C7.17101 -1.02501 13.8199 -1.02501 17.9221 3.07503C19.8928 5.04411 21 7.71567 21 10.5014C21 13.2872 19.8928 15.9588 17.9221 17.9279C15.9591 19.9029 13.2868 21.0093 10.5021 20.9999Z"
                    fill="white"
                  />
                  <path
                    opacity="0.4"
                    d="M38.5042 49C33.4942 49.0017 29.1809 45.4636 28.203 40.5499C27.2251 35.6363 29.855 30.7163 34.4839 28.7997C39.1128 26.8831 44.4509 28.504 47.2327 32.6708C50.0144 36.8376 49.4647 42.3893 45.9198 45.9296C43.9563 47.901 41.2866 49.0064 38.5042 49V49Z"
                    fill="white"
                  />
                  <path
                    d="M10.4847 48.98C6.24849 48.9839 2.42697 46.4384 0.801796 42.5304C-0.823376 38.6223 0.0677803 34.121 3.05979 31.1252C3.51719 30.6797 4.01424 30.2766 4.54478 29.9211L5.05753 29.5952C5.41712 29.3823 5.79003 29.1894 6.18292 29.0031C6.38269 28.9166 6.58246 28.8235 6.80221 28.7437C7.21105 28.5945 7.62926 28.4722 8.05413 28.3778L8.32049 28.3046C8.36618 28.2883 8.41289 28.2749 8.46033 28.2647L10.831 28.0917C11.1373 28.0917 11.4969 28.1516 11.8232 28.1982H11.8964H12.2094H12.3093H12.4092H13.0485C17.1466 28.1601 21.0586 26.4829 23.9095 23.5416C26.7761 20.6225 28.3458 16.6736 28.2645 12.5852V12.4721V12.359C28.241 12.2317 28.2277 12.1026 28.2246 11.9732V11.6539L28.138 11.3479C28.138 11.1616 28.0914 10.962 28.0847 10.7691L28.2446 8.57383V8.52062V8.4807C28.2446 8.42748 28.3444 8.13478 28.3444 8.13478C28.4457 7.68378 28.5747 7.23945 28.7307 6.80432C28.8039 6.60475 28.8971 6.40518 28.9904 6.20561C29.1652 5.81168 29.3654 5.42948 29.5897 5.06141V5.00154C29.6829 4.84854 29.7695 4.69553 29.876 4.54918C30.2259 4.02252 30.625 3.53025 31.068 3.07902C35.165 -1.02114 41.8135 -1.02709 45.9178 3.06571C50.0222 7.15852 50.0281 13.8002 45.9312 17.9004C45.4763 18.3421 44.9814 18.7407 44.4528 19.0912C44.293 19.2042 44.1532 19.2841 44.0133 19.3706L43.9334 19.4171C43.5472 19.6433 43.1743 19.8429 42.8147 20.0092C42.6016 20.1023 42.4085 20.1954 42.2087 20.2686C41.7884 20.4211 41.3592 20.5477 40.9235 20.6478C40.8313 20.6673 40.7401 20.6918 40.6505 20.721L40.484 20.7675L38.16 20.9272C37.867 20.9272 37.554 20.874 37.2277 20.8341H37.0812H36.7815H36.5884H36.4819H35.9625C27.4692 20.9581 20.6693 27.9086 20.7397 36.3938V36.5069V36.6267C20.7577 36.7434 20.7689 36.8612 20.773 36.9792C20.773 37.1056 20.773 37.2254 20.8063 37.3451C20.8396 37.4649 20.8063 37.5713 20.8463 37.691C20.8695 37.8631 20.8829 38.0363 20.8862 38.2099L20.7198 40.4917C20.7074 40.5523 20.6918 40.6123 20.6731 40.6713L20.6132 40.8775C20.5179 41.3293 20.3911 41.7739 20.2336 42.208C20.1604 42.4075 20.0605 42.6138 19.9673 42.82C19.798 43.2042 19.6091 43.5794 19.4013 43.9442C19.2947 44.1305 19.1948 44.2968 19.0816 44.4565C18.7288 44.9887 18.3251 45.4855 17.8763 45.9399C15.919 47.9031 13.2583 49.0046 10.4847 49V48.98Z"
                    fill="white"
                  />
                </svg>
              </div>
              <h1 className="title">Welcome to our CRM</h1>
              <p className="smallText">Enter your details to proceed further</p>
            </SmallScreenTopTitles>

            <Title>
              Welcome to our CRM. <br />
              Sign In to see latest updates.
            </Title>
            <SubText>Enter your details to proceed further</SubText>
            <FormWrapper>
              <StyledForm>
                <FormGroup>
                  <div className="fullname">
                    <label htmlFor="email">Full name</label>
                    <InputWrapper>
                      <input id="email" type="text" />
                      <div className="icon">
                        <svg
                          width="12"
                          height="13"
                          viewBox="0 0 12 13"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M6 0.0625C5.28516 0.0625 4.62305 0.238281 4.01367 0.589844C3.41602 0.941406 2.94141 1.42188 2.58984 2.03125C2.23828 2.62891 2.0625 3.28516 2.0625 4C2.0625 4.66797 2.21484 5.28906 2.51953 5.86328C2.83594 6.4375 3.26367 6.90625 3.80273 7.26953C3.13477 7.5625 2.53711 7.9668 2.00977 8.48242C1.49414 8.99805 1.0957 9.58984 0.814453 10.2578C0.521484 10.9492 0.375 11.6758 0.375 12.4375H1.5C1.5 11.6406 1.69336 10.9023 2.08008 10.2227C2.4668 9.54297 2.98828 9.00391 3.64453 8.60547C3.83203 9.07422 4.13672 9.45508 4.55859 9.74805C4.99219 10.041 5.47266 10.1875 6 10.1875C6.52734 10.1875 7.00195 10.041 7.42383 9.74805C7.85742 9.45508 8.16797 9.07422 8.35547 8.60547C9.01172 9.00391 9.5332 9.54297 9.91992 10.2227C10.3066 10.9023 10.5 11.6406 10.5 12.4375H11.625C11.625 11.6758 11.4785 10.9492 11.1855 10.2578C10.9043 9.58984 10.5 8.99805 9.97266 8.48242C9.45703 7.9668 8.86523 7.5625 8.19727 7.26953C8.73633 6.90625 9.1582 6.4375 9.46289 5.86328C9.7793 5.28906 9.9375 4.66797 9.9375 4C9.9375 3.28516 9.76172 2.62891 9.41016 2.03125C9.05859 1.42188 8.57812 0.941406 7.96875 0.589844C7.37109 0.238281 6.71484 0.0625 6 0.0625ZM6 1.1875C6.51562 1.1875 6.98438 1.31641 7.40625 1.57422C7.83984 1.82031 8.17969 2.16016 8.42578 2.59375C8.68359 3.01562 8.8125 3.48437 8.8125 4C8.8125 4.51562 8.68359 4.99023 8.42578 5.42383C8.17969 5.8457 7.83984 6.18555 7.40625 6.44336C6.98438 6.68945 6.51562 6.8125 6 6.8125C5.48438 6.8125 5.00977 6.68945 4.57617 6.44336C4.1543 6.18555 3.81445 5.8457 3.55664 5.42383C3.31055 4.99023 3.1875 4.51562 3.1875 4C3.1875 3.48437 3.31055 3.01562 3.55664 2.59375C3.81445 2.16016 4.1543 1.82031 4.57617 1.57422C5.00977 1.31641 5.48438 1.1875 6 1.1875ZM6 7.9375C6.45703 7.9375 6.89648 8.00195 7.31836 8.13086C7.22461 8.41211 7.05469 8.64062 6.80859 8.81641C6.57422 8.98047 6.30469 9.0625 6 9.0625C5.69531 9.0625 5.41992 8.98047 5.17383 8.81641C4.93945 8.64062 4.77539 8.41211 4.68164 8.13086C5.10352 8.00195 5.54297 7.9375 6 7.9375Z"
                            fill="#1C1D21"
                          />
                        </svg>
                      </div>
                    </InputWrapper>
                  </div>
                </FormGroup>

                <FormGroup>
                  <label htmlFor="email">Username</label>
                  <InputWrapper>
                    <input
                      id="username"
                      type="text"
                      onChange={props.handleChange("username")}
                      value={props.values.username}
                      onBlur={props.handleBlur("username")}
                    />
                    <div className="icon">
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M8 0.9375L7.70117 1.13086L0.6875 5.70117V15.5625H15.3125V5.70117L8.29883 1.13086L8 0.9375ZM8 2.27344L13.7305 6L8 9.70898L2.26953 6L8 2.27344ZM1.8125 7.03711L7.70117 10.8516L8 11.0449L14.1875 7.03711V14.4375H1.8125V7.03711Z"
                          fill="#1C1D21"
                        />
                      </svg>
                    </div>
                  </InputWrapper>
                  <div style={{ color: "red" }}>
                    {props.touched.username && props.errors.username}
                  </div>
                </FormGroup>

                <FormGroup>
                  <label htmlFor="password">Password</label>
                  <InputWrapper>
                    <input
                      id="password"
                      type="password"
                      placeholder="Start typing..."
                      onChange={props.handleChange("password")}
                      value={props.values.password}
                      onBlur={props.handleBlur("password")}
                    />
                    <div className="icon">
                      <svg
                        width="12"
                        height="16"
                        viewBox="0 0 12 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M6 0.9375C5.29688 0.9375 4.64062 1.11914 4.03125 1.48242C3.43359 1.83398 2.95312 2.31445 2.58984 2.92383C2.23828 3.52148 2.0625 4.17188 2.0625 4.875V6.5625H0.375V15.5625H11.625V6.5625H9.9375V4.875C9.9375 4.17188 9.75586 3.52148 9.39258 2.92383C9.04102 2.31445 8.56055 1.83398 7.95117 1.48242C7.35352 1.11914 6.70312 0.9375 6 0.9375ZM6 2.0625C6.50391 2.0625 6.97266 2.19141 7.40625 2.44922C7.83984 2.69531 8.17969 3.03516 8.42578 3.46875C8.68359 3.90234 8.8125 4.37109 8.8125 4.875V6.5625H3.1875V4.875C3.1875 4.37109 3.31055 3.90234 3.55664 3.46875C3.81445 3.03516 4.16016 2.69531 4.59375 2.44922C5.02734 2.19141 5.49609 2.0625 6 2.0625ZM1.5 7.6875H10.5V14.4375H1.5V7.6875Z"
                          fill="#8181A5"
                        />
                      </svg>
                    </div>
                  </InputWrapper>
                  <div style={{ color: "red" }}>
                    {props.touched.password && props.errors.password}
                  </div>
                </FormGroup>

                <BottomFormGroup>
                  <div className="top">
                    <div>
                      <input id="remember" type="radio" />
                      <label htmlFor="remember" className="remember">
                        Remember me
                      </label>
                    </div>
                    <label className="recover">
                      <Link to="/">Recover password</Link>
                    </label>
                  </div>

                  <div className="bottom">
                    <Button type="signin" onClick={props.handleSubmit}>
                      <Link to="/dashboard">Sign In</Link>
                    </Button>
                    <Button type="signup">
                      <Link to="/">Sign Up</Link>
                    </Button>
                  </div>
                </BottomFormGroup>
              </StyledForm>

              <SocialLogin>
                <div className="socialIcons">
                  <div className="icon">
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 12 12"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M5.96018 4.81188V7.18812C5.96018 7.18812 8.25006 7.18503 9.18245 7.18503C8.67754 8.72548 7.89245 9.56436 5.96018 9.56436C4.00471 9.56436 2.47849 7.96853 2.47849 6C2.47849 4.03147 4.00471 2.43564 5.96018 2.43564C6.99406 2.43564 7.66178 2.80147 8.27426 3.31135C8.76453 2.8178 8.72357 2.74747 9.9709 1.56166C8.91206 0.591446 7.50475 0 5.96018 0C2.66845 0 0 2.68628 0 6C0 9.31366 2.66845 12 5.96018 12C10.8804 12 12.083 7.68713 11.6843 4.81188H5.96018Z"
                        fill="#8181A5"
                      />
                    </svg>
                  </div>
                  <div className="icon">
                    <svg
                      width="7"
                      height="14"
                      viewBox="0 0 7 14"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M4.34375 14V6.99918H6.27628L6.53239 4.58666H4.34375L4.34703 3.37917C4.34703 2.74995 4.40682 2.41279 5.31056 2.41279H6.51871V0H4.5859C2.26429 0 1.44714 1.17033 1.44714 3.13846V4.58693H0V6.99945H1.44714V14H4.34375Z"
                        fill="#8181A5"
                      />
                    </svg>
                  </div>
                  <div className="icon">
                    <svg
                      width="15"
                      height="12"
                      viewBox="0 0 15 12"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M14.25 2.06641C13.875 2.62891 13.418 3.10937 12.8789 3.50781V3.85938C12.8789 4.79688 12.7031 5.72265 12.3516 6.63672C12 7.55079 11.502 8.39453 10.8574 9.16797C10.2129 9.94141 9.38086 10.5625 8.36133 11.0312C7.34179 11.5 6.22266 11.7344 5.00391 11.7344C3.45702 11.7344 2.03907 11.3242 0.75 10.5039C0.960939 10.5273 1.18359 10.5391 1.41797 10.5391C2.70704 10.5391 3.85546 10.1406 4.86328 9.34375C4.2539 9.34375 3.71485 9.16211 3.24609 8.79883C2.77734 8.43554 2.44922 7.97266 2.26172 7.41016C2.42578 7.45703 2.60156 7.48047 2.78906 7.48047C3.04688 7.48047 3.29297 7.44531 3.52734 7.375C2.87109 7.23437 2.33203 6.91211 1.91016 6.4082C1.48828 5.90429 1.27734 5.32422 1.27734 4.66797V4.63281C1.67578 4.84375 2.09765 4.96094 2.54297 4.98438C1.72265 4.42187 1.3125 3.64844 1.3125 2.66406C1.3125 2.17187 1.4414 1.70313 1.69922 1.25781C3.17579 3.08595 5.07421 4.05859 7.39453 4.17578C7.34766 3.96484 7.32422 3.75391 7.32422 3.54297C7.32422 2.76953 7.59375 2.11328 8.13281 1.57422C8.67188 1.03515 9.32812 0.765625 10.1016 0.765625C10.8984 0.765625 11.5664 1.05859 12.1055 1.64453C12.7383 1.52734 13.3242 1.30469 13.8633 0.976562C13.6523 1.63282 13.2539 2.13672 12.668 2.48828C13.207 2.41797 13.7344 2.27734 14.25 2.06641Z"
                        fill="#8181A5"
                      />
                    </svg>
                  </div>
                </div>

                <p className="siginText">Or sign in with</p>
              </SocialLogin>
            </FormWrapper>
          </Wrapper>

          <GradientBackground>
            <img
              alt="gradient-background"
              src={require("../../images/bg.png")}
            />
          </GradientBackground>
        </Container>
      )}
    </Formik>
  );
};

export default Auth;
